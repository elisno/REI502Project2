\section{Metric-based rule selection}

After removing uneven attributes and discretizing all of the numerical attributes in our data set, we can investigate the rules generated by the Apriori algorithm. 

We have 4 potential metrics for ranking our rules.
\begin{itemize}
\item Confidence
\item Lift
\item Leverage
\item Conviction
\end{itemize}
%
\subsection{Confidence}
Setting a threshold for this metric ($minconf = 0.95$) results in hundreds of high confidence rules.
E.g. running 
\begin{verbatim}
	   weka.associations.Apriori -I -R -N 1000 -T 0 -C 0.95 -D 0.05 -U 1.0 -M 0.1 -S -1.0 -c 24
\end{verbatim}

\begin{itemize}

\item \verb|95. surgery=Treated without surgery |

\verb|peripheral pulse=Normal| 

\verb|site of lesion=0| 

\verb|outcome=Lived 39| 

\verb|   ==>|

\verb|surgical lesion=No 39|

\verb|<conf:(1)> lift:(2.71) lev:(0.07) [24] conv:(24.59)|

%%%%%
%%%%%

\item \verb|105. peristalsis=Absent,|

\verb|abdominal distension=Severe,|

\verb|nasogastric reflux=>1liter,|

\verb|rectal examination - feces=Decreased 39|

\verb|   ==>|

\verb|abdomen=Distended lg intestine 39|

\verb|<conf:(1)> lift:(1.54) lev:(0.04) [13] conv:(13.67)|

%%%%%
%%%%%

\item \verb|844. capillary refill time=<3sec,|

\verb|abdominocentesis appearance=Cloudy,|

\verb|site of lesion=0 40| 

\verb|   ==>|

\verb|surgical lesion=No ,|

\verb|outcome=Lived 38|

\verb|<conf:(0.95)> lift:(3.21) lev:(0.07) [26] conv:(9.38)|
\end{itemize}
%
The first rule can be considered as an obvious rule (non-existing lesions don't require surgical intervention).
However, the next rule has identical support and confidence and can be useful in a diagnostic sense.
The last rule can potentially help with making a prognosis (in select few cases).


\subsection{Lift}
We get 460 rules when we set $minlift = 4.0$ and run
\begin{verbatim}
	  weka.associations.Apriori -I -R -N 1000 -T 1 -C 4.0 -D 0.05 -U 1.0 -M 0.1 -S -1.0 -c 24
\end{verbatim}
With moderately high confidence, we get an interesting rule, which may be suitable for diagnosis:
\begin{itemize}
\item   \verb|8. peripheral pulse=Reduced|

\verb|pain=Continous severe pain| 

\verb|peristalsis=Absent| 

\verb|nasogastric tube=None| 

\verb|abdominocentesis appearance=Cloudy 41 |


\verb|==>| 


\verb|temperature of extremities=Cool| 

\verb|abdominal distension=Severe |

\verb|abdomen=Distended lg intestine 37 | 
  
\verb|conf:(0.9) < lift:(4.68)> lev:(0.08) [29] conv:(6.62)|

\end{itemize}



\subsection{Leverage} \label{sec: leve}
Using this metric (e.g. $minleve = 0.1$) results in multiple rules with obvious correlations between their attributes.

\noindent
Running
\begin{verbatim}
	  weka.associations.Apriori -N 100 -T 2 -C 0.1 -D 0.05 -U 1.0 -M 0.1 -S -1.0 -c -1
\end{verbatim} 

\noindent
gives obvious rules on the form:
\begin{itemize}
\item \verb|2. surgery=Treated without surgery| 

\verb|outcome=Lived 110|


\verb|   ==>|
 
\verb|surgical lesion=No 97|

\verb|conf:(0.88) lift:(2.39) < lev:(0.15) [56]> conv:(4.95)|
\end{itemize}
For this metric to be more useful, we need to remove more attributes from the data set.


\subsection{Conviction}
Setting $minconv = 2.0$ and running
\begin{verbatim}
	  weka.associations.Apriori -N 100 -T 3 -C 2.0 -D 0.05 -U 1.0 -M 0.1 -S -1.0 -c -1
\end{verbatim}
results in one interesting rule:
\begin{itemize}
\item \verb|77. rectal temperature='(38.1-38.775]'|

\verb|packed cell volume=31%-50% 89|

\verb|==>|

\verb|outcome=Lived 77|

\verb|conf:(0.87) lift:(1.42) lev:(0.06) [22] < conv:(2.66)>|

\end{itemize}
Increasing $minconv$ results in rules similar to those found when using leverage as a metric. The number of relevant attributes needs to be reduced if we are to find more interesting rules with conviction as a metric.